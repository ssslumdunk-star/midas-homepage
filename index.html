<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Midas - Windows 95 Desktop</title>
    <style>
        /* Simplified Windows 95 Style CSS */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'MS Sans Serif', sans-serif;
            font-size: 11px;
            background: #008080;
            background-image: 
                radial-gradient(circle at 25% 25%, #008080 0%, #008080 50%, transparent 50.5%),
                radial-gradient(circle at 75% 75%, #004040 0%, #004040 50%, transparent 50.5%);
            background-size: 4px 4px;
            min-height: 100vh;
            cursor: default;
        }

        .desktop {
            min-height: calc(100vh - 28px);
            position: relative;
            padding: 10px;
        }

        /* Desktop Icons */
        .desktop-icon {
            position: absolute;
            width: 64px;
            text-align: center;
            cursor: pointer;
            user-select: none;
            color: white;
            text-shadow: 1px 1px 1px rgba(0,0,0,0.8);
            z-index: 1000;
        }

        .desktop-icon:nth-child(1) { top: 50px; left: 50px; }
        .desktop-icon:nth-child(2) { top: 50px; left: 150px; }

        .icon-image {
            width: 32px;
            height: 32px;
            margin: 0 auto 4px;
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
        }

        .icon-label {
            font-size: 11px;
            line-height: 12px;
            word-wrap: break-word;
        }

        /* Trading Calendar Icon */
        .trading-icon {
            background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><rect fill="%23ffcc00" x="4" y="4" width="24" height="24" stroke="%23000" stroke-width="1"/><rect fill="%23ff0000" x="6" y="6" width="20" height="3"/><text x="16" y="16" fill="%23000" text-anchor="middle" font-size="8" font-family="serif">å†</text><circle fill="%23008000" cx="10" cy="22" r="2"/><circle fill="%23ff0000" cx="22" cy="22" r="2"/><path stroke="%23000" stroke-width="1" fill="none" d="M8 12 L12 18 L20 10 L24 16"/></svg>');
        }

        /* Caifu Stock Icon */
        .caifu-icon {
            background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><rect fill="%23667eea" x="2" y="2" width="28" height="28" stroke="%23000" stroke-width="1" rx="3"/><circle fill="%23ffd700" cx="16" cy="12" r="8" stroke="%23000" stroke-width="1"/><text x="16" y="16" fill="%23000" text-anchor="middle" font-size="10" font-family="serif">$</text><path stroke="%23ffd700" stroke-width="2" fill="none" d="M6 22 L12 18 L20 24 L26 20"/><text x="16" y="28" fill="%23fff" text-anchor="middle" font-size="6" font-family="serif">STOCK</text></svg>');
        }

        /* Taskbar */
        .taskbar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: 28px;
            background: #c0c0c0;
            border-top: 1px solid #dfdfdf;
            display: flex;
            align-items: center;
            padding: 2px;
        }

        .start-button {
            background: #c0c0c0;
            border: 2px solid;
            border-color: #dfdfdf #808080 #808080 #dfdfdf;
            padding: 2px 6px;
            font-family: 'MS Sans Serif', sans-serif;
            font-size: 11px;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            height: 22px;
        }

        .start-icon {
            width: 16px;
            height: 16px;
            margin-right: 4px;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><rect fill="%23ff0000" width="8" height="8"/><rect fill="%2300ff00" x="8" width="8" height="8"/><rect fill="%230000ff" y="8" width="8" height="8"/><rect fill="%23ffff00" x="8" y="8" width="8" height="8"/></svg>');
        }

        .system-tray {
            background: #c0c0c0;
            border: 1px inset #c0c0c0;
            padding: 4px 8px;
            font-size: 11px;
            margin-left: auto;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .token-usage {
            color: #0066cc;
            font-weight: bold;
            cursor: help;
        }

        .token-usage i {
            color: #ff6600;
        }

        .window {
            position: fixed;
            background: #c0c0c0;
            border: 2px solid;
            border-color: #dfdfdf #808080 #808080 #dfdfdf;
            min-width: 300px;
            min-height: 200px;
            box-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            display: none;
            z-index: 2000;
        }

        /* Caifuçª—å£ç‰¹æ®Šæ ·å¼ - æ›´å¤§å°ºå¯¸é€‚åˆè‚¡ä»·åˆ†æ */
        #caifu-stock {
            width: 90vw;
            height: 80vh;
            max-width: 1200px;
            max-height: 800px;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
        }

        .window-header {
            background: linear-gradient(90deg, #000080 0%, #000040 100%);
            color: white;
            padding: 2px;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 11px;
            cursor: move;
        }

        .window-content {
            padding: 8px;
            height: calc(100% - 22px);
            overflow: auto;
        }

        /* Trading calendar window */
        #trading-calendar { 
            top: 80px; 
            left: 200px; 
            width: 800px; 
            height: 600px; 
        }

        .loading-container {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            height: 100%;
            background: #c0c0c0;
            font-size: 14px;
            font-weight: bold;
            color: #000080;
        }
    </style>
</head>
<body>
    <div class="desktop">
        <!-- Desktop Icons -->        
        <div class="desktop-icon" data-window="trading-calendar">
            <div class="icon-image trading-icon"></div>
            <div class="icon-label">äº¤æ˜“è€é»„å†</div>
        </div>

        <div class="desktop-icon" data-window="caifu-stock">
            <div class="icon-image caifu-icon"></div>
            <div class="icon-label">è‚¡ä»·ç™¾åˆ†ä½</div>
        </div>

        <!-- Trading Calendar Window -->
        <div class="window" id="trading-calendar">
            <div class="window-header">
                <div class="window-title">
                    <span class="window-icon trading-icon"></span>
                    äº¤æ˜“è€é»„å† - Trading Calendar
                </div>
                <div class="window-controls">
                    <button onclick="closeWindow('trading-calendar')" style="background: #c0c0c0; border: 1px solid; width: 16px; height: 14px; cursor: pointer;">Ã—</button>
                </div>
            </div>
            <div class="window-content" style="padding: 0;">
                <div class="loading-container" id="loading-content">
                    åŠ è½½ä¸­... Loading äº¤æ˜“è€é»„å†...
                </div>
            </div>
        </div>

        <!-- Caifu Stock Window -->
        <div class="window" id="caifu-stock">
            <div class="window-header">
                <div class="window-title">
                    <span class="window-icon caifu-icon"></span>
                    è‚¡ä»·ç™¾åˆ†ä½æŸ¥çœ‹å™¨ - Stock Percentile Viewer
                </div>
                <div class="window-controls">
                    <button onclick="closeWindow('caifu-stock')" style="background: #c0c0c0; border: 1px solid; width: 16px; height: 14px; cursor: pointer;">Ã—</button>
                </div>
            </div>
            <div class="window-content" style="padding: 0;">
                <div class="loading-container" id="caifu-loading-content">
                    åŠ è½½ä¸­... Loading è‚¡ä»·ç™¾åˆ†ä½æŸ¥çœ‹å™¨...
                </div>
            </div>
        </div>
    </div>

    <!-- Taskbar -->
    <div class="taskbar">
        <button class="start-button">
            <span class="start-icon"></span>
            Start
        </button>
        <div class="system-tray">
            <span class="token-usage" id="token-display" title="ä»Šæ—¥AI Tokenä½¿ç”¨æƒ…å†µ">
                <i class="fas fa-robot" style="margin-right: 4px;"></i>
                <span id="token-count">0</span> tokens
            </span>
            <span class="time" id="current-time"></span>
        </div>
    </div>

    <script>
        console.log('ç®€åŒ–ç‰ˆé¡µé¢ JavaScript å¼€å§‹æ‰§è¡Œ');

        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM å·²åŠ è½½');

            // åˆå§‹åŒ–äº¤æ˜“è€é»„å†å›¾æ ‡
            const tradingIcon = document.querySelector('.desktop-icon[data-window="trading-calendar"]');
            console.log('åˆå§‹åŒ–äº¤æ˜“è€é»„å†å›¾æ ‡');
            
            if (tradingIcon) {
                // ç¡®ä¿å›¾æ ‡å¯è§
                tradingIcon.style.display = 'block';
                tradingIcon.style.visibility = 'visible';
                tradingIcon.style.opacity = '1';

                // æ·»åŠ åŒå‡»äº‹ä»¶
                tradingIcon.addEventListener('dblclick', function() {
                    console.log('ğŸ¯ åŒå‡»äº†äº¤æ˜“è€é»„å†å›¾æ ‡');
                    console.log('ğŸ”„ å‡†å¤‡æ‰“å¼€çª—å£å’ŒåŠ è½½iframe');
                    
                    const window = document.getElementById('trading-calendar');
                    window.style.display = 'block';
                    console.log('âœ… äº¤æ˜“è€é»„å†çª—å£å·²æ˜¾ç¤º');
                    
                    // æ˜¾ç¤ºåŠ è½½ä¸­
                    const loadingDiv = document.getElementById('loading-content');
                    loadingDiv.innerHTML = 'ğŸ”„ åŠ è½½ä¸­... Loading äº¤æ˜“è€é»„å†...<br><br>æ­£åœ¨ä»GitHubåŠ è½½é¡¹ç›®...';
                    
                    // 2ç§’ååŠ è½½å®é™…å†…å®¹
                    setTimeout(() => {
                        console.log('â° 2ç§’ç­‰å¾…å®Œæˆï¼Œå¼€å§‹åˆ›å»ºiframe');
                        const content = window.querySelector('.window-content');
                        const iframe = document.createElement('iframe');
                        iframe.src = '/laohuangli/index.html';
                        iframe.style.width = '100%';
                        iframe.style.height = '100%';
                        iframe.style.border = 'none';
                        console.log('ğŸ–¼ï¸ iframeå…ƒç´ å·²åˆ›å»ºï¼Œsrc: ', iframe.src);
                        
                        // ç›‘å¬iframeåŠ è½½å®Œæˆ
                        iframe.onload = function() {
                            console.log('âœ… iframeå†…å®¹åŠ è½½å®Œæˆ');
                            console.log('ğŸ” æ­£åœ¨æ£€æµ‹iframeç¯å¢ƒå’ŒPCç‰ˆå¸ƒå±€...');
                            
                            // ç”±äºæ˜¯æœ¬åœ°åŒåŸŸï¼Œå¯ä»¥ç›´æ¥è®¿é—®iframeå†…å®¹
                            try {
                                const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                                if (iframeDoc) {
                                    console.log('ğŸ¯ æˆåŠŸè®¿é—®iframeæ–‡æ¡£');
                                    console.log('ğŸ“± iframeå†…body classList:', iframeDoc.body.classList.toString());
                                    console.log('ğŸ“ iframeå†…viewport:', iframe.contentWindow.innerWidth + 'x' + iframe.contentWindow.innerHeight);
                                    
                                    // æ£€æŸ¥æ˜¯å¦å·²ç»æœ‰iframe-modeç±»ï¼ˆæˆ‘ä»¬çš„PCç‰ˆä¼˜åŒ–ï¼‰
                                    if (iframeDoc.body.classList.contains('iframe-mode')) {
                                        console.log('âœ… PCç‰ˆå¸ƒå±€å·²è‡ªåŠ¨å¯ç”¨');
                                    } else {
                                        console.log('âš ï¸ æœªæ£€æµ‹åˆ°PCç‰ˆå¸ƒå±€ï¼Œæ‰‹åŠ¨æ·»åŠ iframe-modeç±»');
                                        iframeDoc.body.classList.add('iframe-mode');
                                        console.log('ğŸ”„ æ‰‹åŠ¨æ·»åŠ å classList:', iframeDoc.body.classList.toString());
                                    }
                                } else {
                                    console.log('âŒ æ— æ³•è®¿é—®iframeæ–‡æ¡£');
                                }
                            } catch (e) {
                                console.log('âŒ è®¿é—®iframeæ–‡æ¡£å¤±è´¥:', e.message);
                            }
                        };
                        
                        iframe.onerror = function() {
                            console.log('äº¤æ˜“è€é»„å†å†…å®¹åŠ è½½å¤±è´¥');
                            content.innerHTML = '<div style="padding: 20px; text-align: center; color: red;">âŒ åŠ è½½å¤±è´¥<br>è¯·æ£€æŸ¥ç½‘ç»œè¿æ¥</div>';
                        };
                        
                        content.innerHTML = '';
                        content.appendChild(iframe);
                        console.log('å¼€å§‹åŠ è½½äº¤æ˜“è€é»„å†iframe');
                    }, 2000);
                });

                // å•å‡»é€‰ä¸­æ•ˆæœ
                tradingIcon.addEventListener('click', function() {
                    tradingIcon.style.background = 'rgba(0,0,255,0.3)';
                });
            }

            // åˆå§‹åŒ–è‚¡ä»·ç™¾åˆ†ä½æŸ¥çœ‹å™¨å›¾æ ‡
            const caifuIcon = document.querySelector('.desktop-icon[data-window="caifu-stock"]');
            console.log('åˆå§‹åŒ–è‚¡ä»·ç™¾åˆ†ä½æŸ¥çœ‹å™¨å›¾æ ‡');
            
            if (caifuIcon) {
                // ç¡®ä¿å›¾æ ‡å¯è§
                caifuIcon.style.display = 'block';
                caifuIcon.style.visibility = 'visible';
                caifuIcon.style.opacity = '1';

                // æ·»åŠ åŒå‡»äº‹ä»¶
                caifuIcon.addEventListener('dblclick', function() {
                    console.log('ğŸ¯ åŒå‡»äº†è‚¡ä»·ç™¾åˆ†ä½æŸ¥çœ‹å™¨å›¾æ ‡');
                    console.log('ğŸ”„ å‡†å¤‡æ‰“å¼€çª—å£å’ŒåŠ è½½iframe');
                    
                    const window = document.getElementById('caifu-stock');
                    window.style.display = 'block';
                    console.log('âœ… è‚¡ä»·ç™¾åˆ†ä½æŸ¥çœ‹å™¨çª—å£å·²æ˜¾ç¤º');
                    
                    // æ˜¾ç¤ºåŠ è½½ä¸­
                    const loadingDiv = document.getElementById('caifu-loading-content');
                    loadingDiv.innerHTML = 'ğŸ”„ åŠ è½½ä¸­... Loading è‚¡ä»·ç™¾åˆ†ä½æŸ¥çœ‹å™¨...<br><br>æ­£åœ¨åŠ è½½ç¾è‚¡åˆ†æå·¥å…·...';
                    
                    // 2ç§’ååŠ è½½å®é™…å†…å®¹
                    setTimeout(() => {
                        console.log('â° 2ç§’ç­‰å¾…å®Œæˆï¼Œå¼€å§‹åˆ›å»ºcaifu iframe');
                        const content = window.querySelector('.window-content');
                        const iframe = document.createElement('iframe');
                        iframe.src = '/caifu/index.html';
                        iframe.style.width = '100%';
                        iframe.style.height = '100%';
                        iframe.style.border = 'none';
                        console.log('ğŸ–¼ï¸ caifu iframeå…ƒç´ å·²åˆ›å»ºï¼Œsrc: ', iframe.src);
                        
                        // ç›‘å¬iframeåŠ è½½å®Œæˆ
                        iframe.onload = function() {
                            console.log('âœ… caifu iframeå†…å®¹åŠ è½½å®Œæˆ');
                        };
                        
                        iframe.onerror = function() {
                            console.log('è‚¡ä»·ç™¾åˆ†ä½æŸ¥çœ‹å™¨å†…å®¹åŠ è½½å¤±è´¥');
                            content.innerHTML = '<div style="padding: 20px; text-align: center; color: red;">âŒ åŠ è½½å¤±è´¥<br>è¯·æ£€æŸ¥ç½‘ç»œè¿æ¥</div>';
                        };
                        
                        content.innerHTML = '';
                        content.appendChild(iframe);
                        console.log('å¼€å§‹åŠ è½½è‚¡ä»·ç™¾åˆ†ä½æŸ¥çœ‹å™¨iframe');
                    }, 2000);
                });

                // å•å‡»é€‰ä¸­æ•ˆæœ
                caifuIcon.addEventListener('click', function() {
                    caifuIcon.style.background = 'rgba(0,0,255,0.3)';
                });
            }

            // æ›´æ–°æ—¶é’Ÿ
            function updateClock() {
                const now = new Date();
                const timeString = now.toLocaleTimeString([], {
                    hour: '2-digit',
                    minute: '2-digit'
                });
                document.getElementById('current-time').textContent = timeString;
            }
            updateClock();
            setInterval(updateClock, 1000);

            console.log('é¡µé¢åˆå§‹åŒ–å®Œæˆ');
        });

        // å…³é—­çª—å£å‡½æ•°
        function closeWindow(windowId) {
            const window = document.getElementById(windowId);
            window.style.display = 'none';
            console.log('å…³é—­äº†çª—å£: ' + windowId);
        }
    </script>
</body>
</html>